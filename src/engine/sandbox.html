<!DOCTYPE html>
<html>
<head>
	<title> Sandbox </title>
	<script type="application/javascript" src="/src/engine/BoundingBox.js">	</script>
	<script type="application/javascript" src="/src/engine/QuadTree.js">	</script>
	<script type="application/javascript" src="/src/engine/Canvas2d.js">	</script>
	<script type="application/javascript" src="/src/engine/Debug.js">	</script>
	<style>body { background-color: rgb(150, 150, 200);</style>
</head>
<body>
	<script type="application/javascript">

		var objs = [
			/*{ bb: new BoundingBox(27, 20, 0, 2, 2, 0) }*//*,
			{ bb: new BoundingBox(60, 25, 0, 2, 2, 0) },
			{ bb: new BoundingBox(125, 25, 0, 2, 2, 0) },
			{ bb: new BoundingBox(150, 25, 0, 2, 2, 0) }*/
		];
		var objects = 5000;
		var maxDepth = 4;
		for(var i = 0; i < objects; i++ ) {
			objs.push({ bb: new BoundingBox(Math.floor(Math.random() * 200), Math.floor(Math.random() * 200), 0, 1 + Math.floor(Math.random() * 15), 1 + Math.floor(Math.random() * 15), 0) });
		}
		var canvas = craw({w: 500, h: 500});

		/*var p = new Profiler("quadtree");
		p.start();
		for(var i = 0; i < 1000; i++) {
			var tree = new QuadTree(5, 0, 0, 200, 200, objs);
			var set = tree.get(new BoundingBox(5, 5, 0, 50, 50, 0));
		}
		p.stop();*/

		var p = new Profiler("quadtree");
		p.start();
		var tree = new QuadTree(maxDepth, 0, 0, 200, 200, objs);
		var bb = new BoundingBox(5, 5, 0, 50, 50, 0);
		for(var i = 0; i < objects; i++) {
			var set = tree.get(bb);
		}
		var m = p.stop();
		console.log(set);

		var p2 = new Profiler("quadtree");
		p2.start();
		//var tree = new QuadTree(5, 0, 0, 200, 200, objs);
		//var bb = new BoundingBox(5, 5, 0, 50, 50, 0);
		var z = 0;
		for(var i = 0; i < objects; i++) {
			for(var c = 0; c < objects; c++) {
				if (objs[i].bb.intersect2d(objs[c].bb)) {
					z++;
				}
			}
		}
		console.log(z);
		var m2 = p2.stop();
		alert("max depth " + maxDepth + " quadtree, " + objects + " get tests: \n" + m + "ms\n" + objects + " objects getting " + objects + " objects test: \n" + m2 + "ms");
	</script>
</body>
</html>