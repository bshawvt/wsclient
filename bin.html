<!DOCTYPE html>
<html>
	<head>
		<title> Client page </title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, minimal-ui">
		<meta name="mobile-web-app-capable" content="yes">
		

		<!--<link href="https://fonts.googleapis.com/css?family=Roboto|Montserrat|Thasadith|Coiny" rel="stylesheet">
		

		<link rel="stylesheet" type="text/css" href="/src/core/sandbox.1.css">-->

		<script type="application/javascript" src="/src/engine/Loader.js"></script>
		
	</head>
	<body>
		<div id="app-content">
			<span id="app-loading"></span>
			<script type="text/javascript">

				((e) => {
					var contentContainer = document.getElementById("app-content");

					// list of resources to preload
					var sources = [/*"/bin/client/data/496757__erokia__ambient-wave-48-tribute.wav", */"\\src/engine\\default.phone.css", "\\src/engine\\default.desktop.css", "\\src/engine\\default.tablet.css", "/src/engine/Context.js", "/src/engine/ResourceManager.js", "/src/engine/Template.js", "/src/engine/Animator.js", "/src/engine/BadMath.js", "/src/engine/Canvas2d.js", "/bin/client/data/test.xtt", "/src/engine/Common.js", "/src/engine/Config.js", "/src/engine/Input.js", "/bin/client/data/gradiant.png", "/src/engine/EventManager.js"];
					//var loader = null;
					var loader = new Loader(sources, function(done, asset, key) {
						console.log(loader);
						//if (loader === null) return; // 
						// app-loading is used for displaying information about initial load state
						var d = document.getElementById("app-loading");
												
						//console.log(loader);
						//d.innerText = "Doing things first... " + Math.floor(loader.loads / loader.loadCount * 100) + "%";

						// preload all sources before starting
						if (done) {
							d.innerText = "Click to start";
							var rect = contentContainer.getClientRects()[0];
							var opt = { parent: contentContainer, 
								resources: loader.resource,
								initialWidth: rect.width,
								initialHeight: rect.height
							};
							var app = new Game(opt);
							// user has found and attacked the canvas, clean up and start
							app.context.onactive.addListener("activated", function(e) {
								// remove app-loading element
								contentContainer.removeChild(d);
								app.start();
							}, true); 

						}
						else {
							if (loader !== undefined)
								d.innerText = "Doing things first... " + Math.floor(loader.loads / loader.loadCount * 100) + "%";
						}

					});
				})();
			</script>
		</div>
	</body>
</html>